<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>Animation test</title>
	<style>
		div {
			background-color:#FF0000;
			width: 400px;
			height: 100px;
			position: absolute;
		}
		p {
			position: absolute;
			top: 50%;
			left: 50%;
			margin: 0;
			transform:translate(-50%,-50%);
		}
	</style>
</head>
<body>
	<script>
		var board = [];//holds state of scoreboard
		var MAX_VELOCITY = 4;//maximum velocity of tile
		var ACCELERATION = 0.04;//global acceleration
		var BRAKING_ACCELERATION = 0.01;
		var TILE_WIDTH = 100;//the width (technically css height) of a tile
		var TILE_SPACING = 10;//#of pixels between each tile
		
		function School(schoolName, yPosition, rank){//creates a new school
			this.name = schoolName;
			this.score = 0;
			this.rank = rank;
			this.y = yPosition;
			this.velocity = 0;
			this.acceleration = 0;
			this.direction = 0;
			this.move = function(endPosition, endRank){//animation function
				this.rank = endRank;
				this.direction = Math.sign(endPosition - this.y);
				this.acceleration = this.direction * ACCELERATION;
				if (Math.abs((0-this.velocity*this.velocity)/(2*(endPosition - this.y)))> BRAKING_ACCELERATION && Math.sign(this.velocity) == this.direction){
					this.acceleration = -this.direction * BRAKING_ACCELERATION;
				}
				if (Math.abs(this.velocity) >= MAX_VELOCITY && Math.sign(this.velocity) == this.direction){
					this.velocity = MAX_VELOCITY*this.direction;
				}
				this.velocity += this.acceleration;
				this.y += this.velocity;
				if (Math.sign(endPosition - this.y) == -this.direction){
					this.y = endPosition;
					this.velocity = 0;
					this.acceleration = 0;
					this.direction = 0;
				}
				document.getElementById(this.name).style.top = this.y + "px";
			}
		}
		
		var schools = ["BFH","WHF","FRH","SAL","CLB","ABC","DEF","GHI","JKL"];
		
		function sortTiles(tileA, tileB){//method defining how to sort schools
			return tileB.score - tileA.score;
		}
		
		function main(){//main loop
			board = board.sort(sortTiles);
			for (var i = 0; i < board.length; i++){
				board[i].move(i*(TILE_SPACING+TILE_WIDTH), i);
			}
			window.requestAnimationFrame(main);
		}
		
		function createBoardTiles(tileNameList){//initialization function for board
			var body = document.getElementsByTagName("body")[0];
			for (var i = 0; i < tileNameList.length; i++){
				board.push(new School(tileNameList[i], (TILE_SPACING+TILE_WIDTH)*i, i));
				var divElement = document.createElement("div")
				divElement.id = tileNameList[i];
				divElement.style.top = ((TILE_SPACING+TILE_WIDTH)*i)+"px";
				var pElement = document.createElement("p");
				var node = document.createTextNode(tileNameList[i]);
				pElement.appendChild(node);
				divElement.appendChild(pElement);
				body.appendChild(divElement);
			}
		}
		createBoardTiles(schools);
		window.requestAnimationFrame(main);
	</script>
    </body>
</html>
